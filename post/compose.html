<!DOCTYPE html><html lang="en-US"><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><script>!function(){try {var d=document.documentElement.classList;d.remove('light','dark');var e=localStorage.getItem('theme');if("system"===e||(!e&&true)){var t="(prefers-color-scheme: dark)",m=window.matchMedia(t);m.media!==t||m.matches?d.add('dark'):d.add('light')}else if(e) d.add(e)}catch(e){}}()</script><title>reduxæºç ç³»åˆ—ä¹‹compose | Xu dongdong&#x27;s blog</title><meta name="description" content="A blog created with Next.js and Tailwind.css"/><meta property="og:type" content="website"/><meta name="og:title" property="og:title" content="reduxæºç ç³»åˆ—ä¹‹compose"/><meta name="og:description" property="og:description" content="A blog created with Next.js and Tailwind.css"/><meta name="twitter:card" content="summary"/><meta name="twitter:title" content="reduxæºç ç³»åˆ—ä¹‹compose"/><meta name="twitter:description" content="A blog created with Next.js and Tailwind.css"/><meta name="twitter:creator" content="https://twitter.com/WhyYouJames"/><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"/><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"/><link rel="manifest" href="/site.webmanifest"/><meta name="next-head-count" content="16"/><link rel="preload" href="/_next/static/css/36426ea9e4fb9a363e13.css" as="style"/><link rel="stylesheet" href="/_next/static/css/36426ea9e4fb9a363e13.css" data-n-g=""/><noscript data-n-css=""></noscript><link rel="preload" href="/_next/static/chunks/main-c6f966696d7d46f48c33.js" as="script"/><link rel="preload" href="/_next/static/chunks/webpack-50bee04d1dc61f8adf5b.js" as="script"/><link rel="preload" href="/_next/static/chunks/framework.10b3d8f36ae5d485c3da.js" as="script"/><link rel="preload" href="/_next/static/chunks/commons.18cd929bdef6e2f96561.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/_app-8092af36005895da29ff.js" as="script"/><link rel="preload" href="/_next/static/chunks/1173eff4538ab0eae4f3f506dea9a7965770ad37.7e8955d2d0e73ced77f4.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/post/%5Bslug%5D-5905726faed1db0b6bb8.js" as="script"/></head><body><div id="__next"><div class="w-full min-h-screen dark:bg-gray-700 dark:text-white flex"><div class="max-w-screen-md px-4 py-12 mx-auto antialiased font-body flex flex-col flex-grow"><header class="flex items-center justify-between  mb-2"><div class="max-w-lg"><h1><a class="text-2xl font-black text-black no-underline font-display dark:text-white" href="/">Xu dongdong&#x27;s blog</a></h1></div></header><main class="flex-grow"><article><header class="mb-8"><h1 class="mb-2 text-6xl font-black leading-none font-display">reduxæºç ç³»åˆ—ä¹‹compose</h1><p class="text-sm">June 23, 2021</p></header><div class="mb-4 prose lg:prose-lg dark:prose-dark"><p>æœ¬æ¥æƒ³å†™ <strong>applyMiddleware</strong> æ–¹æ³•ä»£ç è§£æçš„ï¼Œç„¶åä¸€çœ‹ï¼Œé‡Œé¢æœ‰ä¸ª <strong>compose</strong> æ–¹æ³•ï¼Œå¥½åƒå†…éƒ¨ä»£ç ä¹Ÿè°ƒç”¨çš„æ¯”è¾ƒå¤šï¼Œæƒ³äº†æƒ³å°±å†³å®šå…ˆçœ‹ä¸‹ <strong>compose</strong> ç›¸å…³ä»£ç ã€‚</p><pre style="color:#f8f8f2;background:#282a36;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;border-radius:0.3em"><code class="language-javascript" style="color:#f8f8f2;background:none;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token module" style="color:#8be9fd">import</span><span> </span><span class="token imports" style="color:#f8f8f2">{</span><span class="token imports"> compose </span><span class="token imports" style="color:#f8f8f2">}</span><span> </span><span class="token module" style="color:#8be9fd">from</span><span> </span><span class="token" style="color:#50fa7b">&#x27;redux&#x27;</span><span>
</span>
<span></span><span class="token" style="color:#8be9fd">const</span><span> composeFn </span><span class="token" style="color:#f8f8f2">=</span><span> </span><span class="token" style="color:#f1fa8c">compose</span><span class="token" style="color:#f8f8f2">(</span><span>fn1</span><span class="token" style="color:#f8f8f2">,</span><span> fn2</span><span class="token" style="color:#f8f8f2">,</span><span> fn3</span><span class="token" style="color:#f8f8f2">,</span><span> fn4</span><span class="token" style="color:#f8f8f2">)</span><span>
</span><span></span><span class="token" style="color:#8be9fd">const</span><span> b </span><span class="token" style="color:#f8f8f2">=</span><span> </span><span class="token" style="color:#f1fa8c">composeFn</span><span class="token" style="color:#f8f8f2">(</span><span>x</span><span class="token" style="color:#f8f8f2">)</span><span>
</span><span></span><span class="token" style="color:#6272a4">// ç­‰ä»·äº</span><span>
</span><span></span><span class="token" style="color:#8be9fd">const</span><span> b </span><span class="token" style="color:#f8f8f2">=</span><span> </span><span class="token" style="color:#f1fa8c">fn1</span><span class="token" style="color:#f8f8f2">(</span><span class="token" style="color:#f1fa8c">fn2</span><span class="token" style="color:#f8f8f2">(</span><span class="token" style="color:#f1fa8c">fn3</span><span class="token" style="color:#f8f8f2">(</span><span class="token" style="color:#f1fa8c">fn4</span><span class="token" style="color:#f8f8f2">(</span><span>x</span><span class="token" style="color:#f8f8f2">)</span><span class="token" style="color:#f8f8f2">)</span><span class="token" style="color:#f8f8f2">)</span><span class="token" style="color:#f8f8f2">)</span></code></pre><p>ä»ä½¿ç”¨ä¸Šå¤§æ¦‚å¯ä»¥çœ‹å‡ºå®ƒçš„ä½œç”¨ï¼Œä»å³å¾€å·¦çš„ç»„åˆæ‰§è¡Œå¤šä¸ªå‡½æ•°ï¼Œå°†å¤šä¸ªå‡½æ•°ç»„åˆæˆä¸€ä¸ªå‡½æ•°ï¼Œå³è¾¹å‡½æ•°çš„æ‰§è¡Œç»“æœæ˜¯å·¦è¾¹å‡½æ•°çš„å‚æ•°å€¼ï¼Œ
é™¤äº†æœ€å³è¾¹çš„å‡½æ•°å¯ä»¥ä¼ å…¥å¤šä¸ªå‚æ•°ï¼Œå…¶ä½™å‡½æ•°åªèƒ½ä¼ å…¥ä¸€ä¸ªå‚æ•°ã€‚</p><h2>å‚æ•°</h2><ol><li><strong>(arguments)</strong>: éœ€è¦ç»„åˆçš„å‡½æ•°ã€‚</li></ol><h2>è¿”å›å€¼</h2><p><strong>(Function)</strong>: ä»å³åˆ°å·¦æŠŠæ¥æ”¶åˆ°çš„å‡½æ•°åˆæˆåçš„æœ€ç»ˆå‡½æ•°ã€‚</p><h2>ä»£ç ç»“æ„</h2><p>ä»£ç ç®—æ˜¯å¾ˆç®€å•äº†ï¼Œæˆ‘ä»¬åˆ†ä¸¤éƒ¨åˆ†å»ç†è§£</p><h3>ä¸ŠåŠéƒ¨åˆ†</h3><pre style="color:#f8f8f2;background:#282a36;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;border-radius:0.3em"><code class="language-typescript" style="color:#f8f8f2;background:none;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#8be9fd">export</span><span> </span><span class="token" style="color:#8be9fd">default</span><span> </span><span class="token" style="color:#8be9fd">function</span><span> </span><span class="token" style="color:#f1fa8c">compose</span><span class="token" style="color:#f8f8f2">(</span><span class="token" style="color:#f8f8f2">)</span><span class="token" style="color:#f8f8f2">:</span><span> </span><span class="token" style="color:#f8f8f2">&lt;</span><span class="token" style="color:#ff79c6">R</span><span class="token" style="color:#f8f8f2">&gt;</span><span class="token" style="color:#f8f8f2">(</span><span>a</span><span class="token" style="color:#f8f8f2">:</span><span> </span><span class="token" style="color:#ff79c6">R</span><span class="token" style="color:#f8f8f2">)</span><span> </span><span class="token arrow" style="color:#f8f8f2">=&gt;</span><span> </span><span class="token" style="color:#ff79c6">R</span><span>
</span>
<span></span><span class="token" style="color:#8be9fd">export</span><span> </span><span class="token" style="color:#8be9fd">default</span><span> </span><span class="token" style="color:#8be9fd">function</span><span> </span><span class="token generic-function" style="color:#f1fa8c">compose</span><span class="token generic-function generic" style="color:#f8f8f2">&lt;</span><span class="token generic-function generic" style="color:#ff79c6">F</span><span class="token generic-function generic" style="color:#f1fa8c"> </span><span class="token generic-function generic" style="color:#8be9fd">extends</span><span class="token generic-function generic" style="color:#f1fa8c"> </span><span class="token generic-function generic known-class-name" style="color:#f1fa8c">Function</span><span class="token generic-function generic" style="color:#f8f8f2">&gt;</span><span class="token" style="color:#f8f8f2">(</span><span>f</span><span class="token" style="color:#f8f8f2">:</span><span> </span><span class="token" style="color:#ff79c6">F</span><span class="token" style="color:#f8f8f2">)</span><span class="token" style="color:#f8f8f2">:</span><span> </span><span class="token" style="color:#ff79c6">F</span><span>
</span>
<span></span><span class="token" style="color:#6272a4">/* two functions */</span><span>
</span><span></span><span class="token" style="color:#8be9fd">export</span><span> </span><span class="token" style="color:#8be9fd">default</span><span> </span><span class="token" style="color:#8be9fd">function</span><span> </span><span class="token generic-function" style="color:#f1fa8c">compose</span><span class="token generic-function generic" style="color:#f8f8f2">&lt;</span><span class="token generic-function generic" style="color:#ff79c6">A</span><span class="token generic-function generic" style="color:#f8f8f2">,</span><span class="token generic-function generic" style="color:#f1fa8c"> </span><span class="token generic-function generic" style="color:#ff79c6">T</span><span class="token generic-function generic" style="color:#f1fa8c"> </span><span class="token generic-function generic" style="color:#8be9fd">extends</span><span class="token generic-function generic" style="color:#f1fa8c"> </span><span class="token generic-function generic" style="color:#50fa7b">any</span><span class="token generic-function generic" style="color:#f8f8f2">[</span><span class="token generic-function generic" style="color:#f8f8f2">]</span><span class="token generic-function generic" style="color:#f8f8f2">,</span><span class="token generic-function generic" style="color:#f1fa8c"> </span><span class="token generic-function generic" style="color:#ff79c6">R</span><span class="token generic-function generic" style="color:#f8f8f2">&gt;</span><span class="token" style="color:#f8f8f2">(</span><span>
</span><span>  </span><span class="token function-variable" style="color:#f1fa8c">f1</span><span class="token" style="color:#f8f8f2">:</span><span> </span><span class="token" style="color:#f8f8f2">(</span><span>a</span><span class="token" style="color:#f8f8f2">:</span><span> </span><span class="token" style="color:#ff79c6">A</span><span class="token" style="color:#f8f8f2">)</span><span> </span><span class="token arrow" style="color:#f8f8f2">=&gt;</span><span> </span><span class="token" style="color:#ff79c6">R</span><span class="token" style="color:#f8f8f2">,</span><span>
</span><span>  f2</span><span class="token" style="color:#f8f8f2">:</span><span> </span><span class="token maybe-class-name">Func</span><span class="token" style="color:#f8f8f2">&lt;</span><span class="token" style="color:#ff79c6">T</span><span class="token" style="color:#f8f8f2">,</span><span> </span><span class="token" style="color:#ff79c6">A</span><span class="token" style="color:#f8f8f2">&gt;</span><span>
</span><span></span><span class="token" style="color:#f8f8f2">)</span><span class="token" style="color:#f8f8f2">:</span><span> </span><span class="token maybe-class-name">Func</span><span class="token" style="color:#f8f8f2">&lt;</span><span class="token" style="color:#ff79c6">T</span><span class="token" style="color:#f8f8f2">,</span><span> </span><span class="token" style="color:#ff79c6">R</span><span class="token" style="color:#f8f8f2">&gt;</span><span>
</span>
<span></span><span class="token" style="color:#6272a4">/* three functions */</span><span>
</span><span></span><span class="token" style="color:#8be9fd">export</span><span> </span><span class="token" style="color:#8be9fd">default</span><span> </span><span class="token" style="color:#8be9fd">function</span><span> </span><span class="token generic-function" style="color:#f1fa8c">compose</span><span class="token generic-function generic" style="color:#f8f8f2">&lt;</span><span class="token generic-function generic" style="color:#ff79c6">A</span><span class="token generic-function generic" style="color:#f8f8f2">,</span><span class="token generic-function generic" style="color:#f1fa8c"> </span><span class="token generic-function generic" style="color:#ff79c6">B</span><span class="token generic-function generic" style="color:#f8f8f2">,</span><span class="token generic-function generic" style="color:#f1fa8c"> </span><span class="token generic-function generic" style="color:#ff79c6">T</span><span class="token generic-function generic" style="color:#f1fa8c"> </span><span class="token generic-function generic" style="color:#8be9fd">extends</span><span class="token generic-function generic" style="color:#f1fa8c"> </span><span class="token generic-function generic" style="color:#50fa7b">any</span><span class="token generic-function generic" style="color:#f8f8f2">[</span><span class="token generic-function generic" style="color:#f8f8f2">]</span><span class="token generic-function generic" style="color:#f8f8f2">,</span><span class="token generic-function generic" style="color:#f1fa8c"> </span><span class="token generic-function generic" style="color:#ff79c6">R</span><span class="token generic-function generic" style="color:#f8f8f2">&gt;</span><span class="token" style="color:#f8f8f2">(</span><span>
</span><span>  </span><span class="token function-variable" style="color:#f1fa8c">f1</span><span class="token" style="color:#f8f8f2">:</span><span> </span><span class="token" style="color:#f8f8f2">(</span><span>b</span><span class="token" style="color:#f8f8f2">:</span><span> </span><span class="token" style="color:#ff79c6">B</span><span class="token" style="color:#f8f8f2">)</span><span> </span><span class="token arrow" style="color:#f8f8f2">=&gt;</span><span> </span><span class="token" style="color:#ff79c6">R</span><span class="token" style="color:#f8f8f2">,</span><span>
</span><span>  </span><span class="token function-variable" style="color:#f1fa8c">f2</span><span class="token" style="color:#f8f8f2">:</span><span> </span><span class="token" style="color:#f8f8f2">(</span><span>a</span><span class="token" style="color:#f8f8f2">:</span><span> </span><span class="token" style="color:#ff79c6">A</span><span class="token" style="color:#f8f8f2">)</span><span> </span><span class="token arrow" style="color:#f8f8f2">=&gt;</span><span> </span><span class="token" style="color:#ff79c6">B</span><span class="token" style="color:#f8f8f2">,</span><span>
</span><span>  f3</span><span class="token" style="color:#f8f8f2">:</span><span> </span><span class="token maybe-class-name">Func</span><span class="token" style="color:#f8f8f2">&lt;</span><span class="token" style="color:#ff79c6">T</span><span class="token" style="color:#f8f8f2">,</span><span> </span><span class="token" style="color:#ff79c6">A</span><span class="token" style="color:#f8f8f2">&gt;</span><span>
</span><span></span><span class="token" style="color:#f8f8f2">)</span><span class="token" style="color:#f8f8f2">:</span><span> </span><span class="token maybe-class-name">Func</span><span class="token" style="color:#f8f8f2">&lt;</span><span class="token" style="color:#ff79c6">T</span><span class="token" style="color:#f8f8f2">,</span><span> </span><span class="token" style="color:#ff79c6">R</span><span class="token" style="color:#f8f8f2">&gt;</span><span>
</span>
<span></span><span class="token" style="color:#6272a4">/* four functions */</span><span>
</span><span></span><span class="token" style="color:#8be9fd">export</span><span> </span><span class="token" style="color:#8be9fd">default</span><span> </span><span class="token" style="color:#8be9fd">function</span><span> </span><span class="token generic-function" style="color:#f1fa8c">compose</span><span class="token generic-function generic" style="color:#f8f8f2">&lt;</span><span class="token generic-function generic" style="color:#ff79c6">A</span><span class="token generic-function generic" style="color:#f8f8f2">,</span><span class="token generic-function generic" style="color:#f1fa8c"> </span><span class="token generic-function generic" style="color:#ff79c6">B</span><span class="token generic-function generic" style="color:#f8f8f2">,</span><span class="token generic-function generic" style="color:#f1fa8c"> </span><span class="token generic-function generic" style="color:#ff79c6">C</span><span class="token generic-function generic" style="color:#f8f8f2">,</span><span class="token generic-function generic" style="color:#f1fa8c"> </span><span class="token generic-function generic" style="color:#ff79c6">T</span><span class="token generic-function generic" style="color:#f1fa8c"> </span><span class="token generic-function generic" style="color:#8be9fd">extends</span><span class="token generic-function generic" style="color:#f1fa8c"> </span><span class="token generic-function generic" style="color:#50fa7b">any</span><span class="token generic-function generic" style="color:#f8f8f2">[</span><span class="token generic-function generic" style="color:#f8f8f2">]</span><span class="token generic-function generic" style="color:#f8f8f2">,</span><span class="token generic-function generic" style="color:#f1fa8c"> </span><span class="token generic-function generic" style="color:#ff79c6">R</span><span class="token generic-function generic" style="color:#f8f8f2">&gt;</span><span class="token" style="color:#f8f8f2">(</span><span>
</span><span>  </span><span class="token function-variable" style="color:#f1fa8c">f1</span><span class="token" style="color:#f8f8f2">:</span><span> </span><span class="token" style="color:#f8f8f2">(</span><span>c</span><span class="token" style="color:#f8f8f2">:</span><span> </span><span class="token" style="color:#ff79c6">C</span><span class="token" style="color:#f8f8f2">)</span><span> </span><span class="token arrow" style="color:#f8f8f2">=&gt;</span><span> </span><span class="token" style="color:#ff79c6">R</span><span class="token" style="color:#f8f8f2">,</span><span>
</span><span>  </span><span class="token function-variable" style="color:#f1fa8c">f2</span><span class="token" style="color:#f8f8f2">:</span><span> </span><span class="token" style="color:#f8f8f2">(</span><span>b</span><span class="token" style="color:#f8f8f2">:</span><span> </span><span class="token" style="color:#ff79c6">B</span><span class="token" style="color:#f8f8f2">)</span><span> </span><span class="token arrow" style="color:#f8f8f2">=&gt;</span><span> </span><span class="token" style="color:#ff79c6">C</span><span class="token" style="color:#f8f8f2">,</span><span>
</span><span>  </span><span class="token function-variable" style="color:#f1fa8c">f3</span><span class="token" style="color:#f8f8f2">:</span><span> </span><span class="token" style="color:#f8f8f2">(</span><span>a</span><span class="token" style="color:#f8f8f2">:</span><span> </span><span class="token" style="color:#ff79c6">A</span><span class="token" style="color:#f8f8f2">)</span><span> </span><span class="token arrow" style="color:#f8f8f2">=&gt;</span><span> </span><span class="token" style="color:#ff79c6">B</span><span class="token" style="color:#f8f8f2">,</span><span>
</span><span>  f4</span><span class="token" style="color:#f8f8f2">:</span><span> </span><span class="token maybe-class-name">Func</span><span class="token" style="color:#f8f8f2">&lt;</span><span class="token" style="color:#ff79c6">T</span><span class="token" style="color:#f8f8f2">,</span><span> </span><span class="token" style="color:#ff79c6">A</span><span class="token" style="color:#f8f8f2">&gt;</span><span>
</span><span></span><span class="token" style="color:#f8f8f2">)</span><span class="token" style="color:#f8f8f2">:</span><span> </span><span class="token maybe-class-name">Func</span><span class="token" style="color:#f8f8f2">&lt;</span><span class="token" style="color:#ff79c6">T</span><span class="token" style="color:#f8f8f2">,</span><span> </span><span class="token" style="color:#ff79c6">R</span><span class="token" style="color:#f8f8f2">&gt;</span><span>
</span>
<span></span><span class="token" style="color:#6272a4">/* rest */</span><span>
</span><span></span><span class="token" style="color:#8be9fd">export</span><span> </span><span class="token" style="color:#8be9fd">default</span><span> </span><span class="token" style="color:#8be9fd">function</span><span> </span><span class="token generic-function" style="color:#f1fa8c">compose</span><span class="token generic-function generic" style="color:#f8f8f2">&lt;</span><span class="token generic-function generic" style="color:#ff79c6">R</span><span class="token generic-function generic" style="color:#f8f8f2">&gt;</span><span class="token" style="color:#f8f8f2">(</span><span>
</span><span>  </span><span class="token function-variable" style="color:#f1fa8c">f1</span><span class="token" style="color:#f8f8f2">:</span><span> </span><span class="token" style="color:#f8f8f2">(</span><span>a</span><span class="token" style="color:#f8f8f2">:</span><span> </span><span class="token" style="color:#50fa7b">any</span><span class="token" style="color:#f8f8f2">)</span><span> </span><span class="token arrow" style="color:#f8f8f2">=&gt;</span><span> </span><span class="token" style="color:#ff79c6">R</span><span class="token" style="color:#f8f8f2">,</span><span>
</span><span>  </span><span class="token spread" style="color:#f8f8f2">...</span><span>funcs</span><span class="token" style="color:#f8f8f2">:</span><span> </span><span class="token known-class-name" style="color:#f1fa8c">Function</span><span class="token" style="color:#f8f8f2">[</span><span class="token" style="color:#f8f8f2">]</span><span>
</span><span></span><span class="token" style="color:#f8f8f2">)</span><span class="token" style="color:#f8f8f2">:</span><span> </span><span class="token" style="color:#f8f8f2">(</span><span class="token spread" style="color:#f8f8f2">...</span><span>args</span><span class="token" style="color:#f8f8f2">:</span><span> </span><span class="token" style="color:#50fa7b">any</span><span class="token" style="color:#f8f8f2">[</span><span class="token" style="color:#f8f8f2">]</span><span class="token" style="color:#f8f8f2">)</span><span> </span><span class="token arrow" style="color:#f8f8f2">=&gt;</span><span> </span><span class="token" style="color:#ff79c6">R</span><span>
</span>
<span></span><span class="token" style="color:#8be9fd">export</span><span> </span><span class="token" style="color:#8be9fd">default</span><span> </span><span class="token" style="color:#8be9fd">function</span><span> </span><span class="token generic-function" style="color:#f1fa8c">compose</span><span class="token generic-function generic" style="color:#f8f8f2">&lt;</span><span class="token generic-function generic" style="color:#ff79c6">R</span><span class="token generic-function generic" style="color:#f8f8f2">&gt;</span><span class="token" style="color:#f8f8f2">(</span><span class="token spread" style="color:#f8f8f2">...</span><span>funcs</span><span class="token" style="color:#f8f8f2">:</span><span> </span><span class="token known-class-name" style="color:#f1fa8c">Function</span><span class="token" style="color:#f8f8f2">[</span><span class="token" style="color:#f8f8f2">]</span><span class="token" style="color:#f8f8f2">)</span><span class="token" style="color:#f8f8f2">:</span><span> </span><span class="token" style="color:#f8f8f2">(</span><span class="token spread" style="color:#f8f8f2">...</span><span>args</span><span class="token" style="color:#f8f8f2">:</span><span> </span><span class="token" style="color:#50fa7b">any</span><span class="token" style="color:#f8f8f2">[</span><span class="token" style="color:#f8f8f2">]</span><span class="token" style="color:#f8f8f2">)</span><span> </span><span class="token arrow" style="color:#f8f8f2">=&gt;</span><span> </span><span class="token" style="color:#ff79c6">R</span><span>
</span>
<span></span><span class="token" style="color:#8be9fd">export</span><span> </span><span class="token" style="color:#8be9fd">default</span><span> </span><span class="token" style="color:#8be9fd">function</span><span> </span><span class="token" style="color:#f1fa8c">compose</span><span class="token" style="color:#f8f8f2">(</span><span class="token spread" style="color:#f8f8f2">...</span><span>funcs</span><span class="token" style="color:#f8f8f2">:</span><span> </span><span class="token known-class-name" style="color:#f1fa8c">Function</span><span class="token" style="color:#f8f8f2">[</span><span class="token" style="color:#f8f8f2">]</span><span class="token" style="color:#f8f8f2">)</span><span> </span><span class="token" style="color:#f8f8f2">{</span><span>
</span>  
<span></span><span class="token" style="color:#f8f8f2">}</span></code></pre><p>å£°æ˜å„ç§ä¸åŒå‚æ•°çš„ <strong>compose</strong>ï¼Œå…¶å®æ˜¯é‡è½½ï¼Œä¸ºäº†å†™ä»£ç æ—¶æœ‰æ›´å¥½çš„ä»£ç æç¤ºã€‚</p><h3>æ ¸å¿ƒéƒ¨åˆ†</h3><pre style="color:#f8f8f2;background:#282a36;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;border-radius:0.3em"><code class="language-typescript" style="color:#f8f8f2;background:none;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#8be9fd">return</span><span> funcs</span><span class="token" style="color:#f8f8f2">.</span><span class="token method property-access" style="color:#f1fa8c">reduce</span><span class="token" style="color:#f8f8f2">(</span><span>
</span><span>  </span><span class="token" style="color:#f8f8f2">(</span><span>a</span><span class="token" style="color:#f8f8f2">,</span><span> b</span><span class="token" style="color:#f8f8f2">)</span><span> </span><span class="token arrow" style="color:#f8f8f2">=&gt;</span><span>
</span><span>    </span><span class="token" style="color:#f8f8f2">(</span><span class="token spread" style="color:#f8f8f2">...</span><span>args</span><span class="token" style="color:#f8f8f2">:</span><span> </span><span class="token" style="color:#50fa7b">any</span><span class="token" style="color:#f8f8f2">)</span><span> </span><span class="token arrow" style="color:#f8f8f2">=&gt;</span><span>
</span><span>      </span><span class="token" style="color:#f1fa8c">a</span><span class="token" style="color:#f8f8f2">(</span><span class="token" style="color:#f1fa8c">b</span><span class="token" style="color:#f8f8f2">(</span><span class="token spread" style="color:#f8f8f2">...</span><span>args</span><span class="token" style="color:#f8f8f2">)</span><span class="token" style="color:#f8f8f2">)</span><span>
</span><span></span><span class="token" style="color:#f8f8f2">)</span></code></pre><p>æœ€å <strong>compose return</strong> çš„æ˜¯å‡½æ•°æ•°ç»„ï¼ˆå³ä¼ å…¥çš„å‚æ•°ï¼‰çš„ <strong>reduce</strong> æ–¹æ³•ï¼Œæ˜¾è€Œæ˜“è§çš„èƒ½ç»„åˆæˆé«˜é˜¶å‡½æ•°çš„å½¢å¼ã€‚</p><h2>æ€»ç»“</h2><pre style="color:#f8f8f2;background:#282a36;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;border-radius:0.3em"><code class="language-javascript" style="color:#f8f8f2;background:none;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#f1fa8c">compose</span><span class="token" style="color:#f8f8f2">(</span><span>fn1</span><span class="token" style="color:#f8f8f2">,</span><span> fn2</span><span class="token" style="color:#f8f8f2">,</span><span> fn3</span><span class="token" style="color:#f8f8f2">,</span><span> fn4</span><span class="token" style="color:#f8f8f2">)</span><span class="token" style="color:#f8f8f2">(</span><span class="token spread" style="color:#f8f8f2">...</span><span>args</span><span class="token" style="color:#f8f8f2">)</span><span> </span><span class="token" style="color:#f8f8f2">===</span><span> </span><span class="token" style="color:#f1fa8c">fn1</span><span class="token" style="color:#f8f8f2">(</span><span class="token" style="color:#f1fa8c">fn2</span><span class="token" style="color:#f8f8f2">(</span><span class="token" style="color:#f1fa8c">fn3</span><span class="token" style="color:#f8f8f2">(</span><span class="token" style="color:#f1fa8c">fn4</span><span class="token" style="color:#f8f8f2">(</span><span class="token spread" style="color:#f8f8f2">...</span><span>args</span><span class="token" style="color:#f8f8f2">)</span><span class="token" style="color:#f8f8f2">)</span><span class="token" style="color:#f8f8f2">)</span><span class="token" style="color:#f8f8f2">)</span></code></pre><p><strong>compose</strong> å‡½æ•°åœ¨å‡½æ•°å¼ç¼–ç¨‹é‡Œå¾ˆå¸¸è§ã€‚è¿™é‡Œ <strong>redux</strong> çš„å¯¹ <strong>compose</strong> å®ç°å¾ˆç®€å•ï¼Œä¸»è¦è¿˜æ˜¯è¦å¯¹ <strong>Array.prototype.reduce</strong> å‡½æ•°è¦ç†Ÿç»ƒã€‚</p></div><hr class="mt-4"/><footer><div class="flex items-center mt-8 mb-16"><picture class="flex-shrink-0 mb-0 mr-3 rounded-full w-14 h-14 select-none cursor-pointer hvr-float-shadow"><source type="image/webp" data-srcset="/_next/static/images/profile-8ed88833980dc158e6d9ec3b1bb7c0a8.png.webp"/><source type="image/png" data-srcset="/_next/static/images/profile-44443f720aaa2ff4c2b67336ff9f586b.png"/><img class="lazyload blur flex-shrink-0 mb-0 mr-3 rounded-full w-14 h-14 select-none cursor-pointer hvr-float-shadow" alt="Profile" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAJCAYAAAALpr0TAAAAAklEQVR4AewaftIAAAFBSURBVAXBSS8DYQCA4fcz33RqWpUuU8tEkKjtUqIhJELiRCJxcfRf/AknP8OFiwMXF40DSVO0iRhLVbR0mX08jzg63Ikc28NzA1QR8vBcJ6Eq9AYUDMNAxlOsrBSRH40WIoLJbIL1qTzS63JvfRKJECd0MM0h9IREmZ4YOyaAw7UCG6UlNpfneaw8UbNa4Ie4tk9uSEO6nouCoO9FZEZNWu8WcUViZpLsH+wyMjnBX7eDzCuQ0zVsAtpvb1RrL9Stb3RNkO//MSwl6mAcWRrNMLO1jZ5UuSiXITXO6vISp+eXbNs+olal02kj/YUidiyJ5wsK63u8N74xSxmmyrecnF2TNtJoUkUa2RxO95ew3+al1yXm9tCCiLnCLPqrRbP5QSRC5GLsi0DVkekUj5UKjZ8+TSdA6ikWigYDqs/VzR3/TEV/Airrby8AAAAASUVORK5CYII="/></picture><p class="text-base leading-7">Written by <b class="font-semibold">xudd</b> <!-- -->who wants to become richï¼ï¼ï¼<!-- --> <a href="https://twitter.com/https://twitter.com/WhyYouJames">Follow him on twitter</a></p></div></footer></article><nav class="flex flex-wrap justify-between mb-10"><a class="text-lg font-bold" href="/post/createStore">â† <!-- -->reduxæºç ç³»åˆ—ä¹‹createStore</a><a class="text-lg font-bold" href="/post/currying">æŸ¯é‡ŒåŒ–-Currying<!-- --> â†’</a></nav></main><footer class="text-lg font-light mt-3">Â© <!-- -->2021<!-- --> <a href="https://github.com/aaronxdd">Dongdong Xu</a>, Built with<!-- --> <a href="https://nextjs.org/">Next.js</a>ğŸ”¥, Deployed on<!-- --> <a href="https://pages.github.com/">GitHub Pages</a></footer></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"frontmatter":{"title":"reduxæºç ç³»åˆ—ä¹‹compose","date":"June 23, 2021","description":null},"post":{"content":"\næœ¬æ¥æƒ³å†™ **applyMiddleware** æ–¹æ³•ä»£ç è§£æçš„ï¼Œç„¶åä¸€çœ‹ï¼Œé‡Œé¢æœ‰ä¸ª **compose** æ–¹æ³•ï¼Œå¥½åƒå†…éƒ¨ä»£ç ä¹Ÿè°ƒç”¨çš„æ¯”è¾ƒå¤šï¼Œæƒ³äº†æƒ³å°±å†³å®šå…ˆçœ‹ä¸‹ **compose** ç›¸å…³ä»£ç ã€‚\n\n``` javascript\nimport { compose } from 'redux'\n\nconst composeFn = compose(fn1, fn2, fn3, fn4)\nconst b = composeFn(x)\n// ç­‰ä»·äº\nconst b = fn1(fn2(fn3(fn4(x))))\n```\nä»ä½¿ç”¨ä¸Šå¤§æ¦‚å¯ä»¥çœ‹å‡ºå®ƒçš„ä½œç”¨ï¼Œä»å³å¾€å·¦çš„ç»„åˆæ‰§è¡Œå¤šä¸ªå‡½æ•°ï¼Œå°†å¤šä¸ªå‡½æ•°ç»„åˆæˆä¸€ä¸ªå‡½æ•°ï¼Œå³è¾¹å‡½æ•°çš„æ‰§è¡Œç»“æœæ˜¯å·¦è¾¹å‡½æ•°çš„å‚æ•°å€¼ï¼Œ\né™¤äº†æœ€å³è¾¹çš„å‡½æ•°å¯ä»¥ä¼ å…¥å¤šä¸ªå‚æ•°ï¼Œå…¶ä½™å‡½æ•°åªèƒ½ä¼ å…¥ä¸€ä¸ªå‚æ•°ã€‚\n\n## å‚æ•°\n1. **(arguments)**: éœ€è¦ç»„åˆçš„å‡½æ•°ã€‚\n\n## è¿”å›å€¼\n**(Function)**: ä»å³åˆ°å·¦æŠŠæ¥æ”¶åˆ°çš„å‡½æ•°åˆæˆåçš„æœ€ç»ˆå‡½æ•°ã€‚\n\n## ä»£ç ç»“æ„\nä»£ç ç®—æ˜¯å¾ˆç®€å•äº†ï¼Œæˆ‘ä»¬åˆ†ä¸¤éƒ¨åˆ†å»ç†è§£\n\n### ä¸ŠåŠéƒ¨åˆ†\n\n``` typescript\nexport default function compose(): \u003cR\u003e(a: R) =\u003e R\n\nexport default function compose\u003cF extends Function\u003e(f: F): F\n\n/* two functions */\nexport default function compose\u003cA, T extends any[], R\u003e(\n  f1: (a: A) =\u003e R,\n  f2: Func\u003cT, A\u003e\n): Func\u003cT, R\u003e\n\n/* three functions */\nexport default function compose\u003cA, B, T extends any[], R\u003e(\n  f1: (b: B) =\u003e R,\n  f2: (a: A) =\u003e B,\n  f3: Func\u003cT, A\u003e\n): Func\u003cT, R\u003e\n\n/* four functions */\nexport default function compose\u003cA, B, C, T extends any[], R\u003e(\n  f1: (c: C) =\u003e R,\n  f2: (b: B) =\u003e C,\n  f3: (a: A) =\u003e B,\n  f4: Func\u003cT, A\u003e\n): Func\u003cT, R\u003e\n\n/* rest */\nexport default function compose\u003cR\u003e(\n  f1: (a: any) =\u003e R,\n  ...funcs: Function[]\n): (...args: any[]) =\u003e R\n\nexport default function compose\u003cR\u003e(...funcs: Function[]): (...args: any[]) =\u003e R\n\nexport default function compose(...funcs: Function[]) {\n  \n}\n```\n\nå£°æ˜å„ç§ä¸åŒå‚æ•°çš„ **compose**ï¼Œå…¶å®æ˜¯é‡è½½ï¼Œä¸ºäº†å†™ä»£ç æ—¶æœ‰æ›´å¥½çš„ä»£ç æç¤ºã€‚\n\n### æ ¸å¿ƒéƒ¨åˆ†\n``` typescript\nreturn funcs.reduce(\n  (a, b) =\u003e\n    (...args: any) =\u003e\n      a(b(...args))\n)\n```\næœ€å **compose return** çš„æ˜¯å‡½æ•°æ•°ç»„ï¼ˆå³ä¼ å…¥çš„å‚æ•°ï¼‰çš„ **reduce** æ–¹æ³•ï¼Œæ˜¾è€Œæ˜“è§çš„èƒ½ç»„åˆæˆé«˜é˜¶å‡½æ•°çš„å½¢å¼ã€‚\n\n## æ€»ç»“\n\n``` javascript\ncompose(fn1, fn2, fn3, fn4)(...args) === fn1(fn2(fn3(fn4(...args))))\n```\n\n**compose** å‡½æ•°åœ¨å‡½æ•°å¼ç¼–ç¨‹é‡Œå¾ˆå¸¸è§ã€‚è¿™é‡Œ **redux** çš„å¯¹ **compose** å®ç°å¾ˆç®€å•ï¼Œä¸»è¦è¿˜æ˜¯è¦å¯¹ **Array.prototype.reduce** å‡½æ•°è¦ç†Ÿç»ƒã€‚\n\n","excerpt":""},"previousPost":{"slug":"createStore","frontmatter":{"title":"reduxæºç ç³»åˆ—ä¹‹createStore","date":"June 23, 2021","description":"æ·±å…¥æºç è§£æcreateStoreå†…éƒ¨ä»£ç "},"excerpt":"","content":"\n``` javascript\nconst store = createStore(reducer, [initState, enhancer])\n```\n\n## å‚æ•°\n\n1. [**reducer**](https://redux.js.org/understanding/thinking-in-redux/glossary#reducer) (*Function*):  æ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œåˆ†åˆ«æ˜¯å½“å‰çš„ **state** å’Œè¦å¤„ç†çš„ [**action**](https://redux.js.org/tutorials/fundamentals/part-2-concepts-data-flow#actions)\n\n2. [**preloadedState**] (*any*):  åˆå§‹çŠ¶æ€çš„ **state**ï¼Œå…¶å®åœ¨å®é™…å¼€å‘ä¸­å¾ˆå°‘åœ¨è¿™è¾¹ç»™åº”ç”¨èµ‹ä¸Šåˆå§‹ **state**ï¼Œä¸€èˆ¬ä¼šåœ¨å„è‡ªçš„ **reducer** ä¸­èµ‹ä¸Šåˆå§‹ **state**: \n\n``` javascript\nconst initialState = {}\n\n  // reducer\nconst todoApp = (state = initialState, action) =\u003e {\n  // è¿™é‡Œæš‚ä¸å¤„ç†ä»»ä½• actionï¼Œ\n  // ä»…è¿”å›ä¼ å…¥çš„ stateã€‚\n  return state\n}\n```\nå€¼å¾—æ³¨æ„çš„æ˜¯: é€šå¸¸æƒ…å†µä¸‹ï¼Œé€šè¿‡ **preloadedState** æŒ‡å®šçš„ **state** è¦ä¼˜å…ˆäºé€šè¿‡ **reducer** æŒ‡å®š **state** : \n\n``` javascript\nimport { createStore } from 'redux';\n// reducer\nconst a = (state = 'lol', action) =\u003e {\n  return state;\n}\n\nconst b = (state = 'wat', action) =\u003e {\n  return state;\n}\n\n// const combined = combineReducers({ a, b })\nconst combined = (state = {}, action) =\u003e {\n  return {\n    a: a(state.a, action),\n    b: b(state.b, action)\n  };\n}\n\nconst store = createStore(combined, { a: 'horse' });\nconsole.log(store.getState()); // { a: 'horse', b: 'wat' }\n```\n\n3. [**enhancer**] (*Function*):  é«˜é˜¶å‡½æ•°ï¼Œé€šå¸¸æ˜¯æŒ‡ä¸­é—´ä»¶ï¼Œå¿…é¡»ç”¨ **applyMiddleware()** åŒ…è£…ä¸‹ï¼š\n\n``` javascript\nimport { createStore, applyMiddleware } from 'redux';\nimport thunk from 'redux-thunk';\n\nfunction logger({ getState }) {\n  return next =\u003e action =\u003e {\n    console.log('will dispatch', action)\n\n    // Call the next dispatch method in the middleware chain.\n    const returnValue = next(action)\n\n    console.log('state after dispatch', getState())\n\n    // This will likely be the action itself, unless\n    // a middleware further in chain changed it.\n    return returnValue\n  }\n}\n\nconst store = createStore(todos, applyMiddleware(thunk, logger))\n```\n\n## è¿”å›å€¼\n[**store**](https://redux.js.org/api/store): æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼ŒåŒ…å«äº†ä¸€äº›æ–¹æ³•ï¼ˆ[**dispatch**](https://redux.js.org/api/store#dispatchaction)ï¼Œ[**getState**](https://redux.js.org/api/store#getstate)ç­‰)ï¼Œä¿å­˜äº†åº”ç”¨æ‰€æœ‰ **state** çš„å¯¹è±¡ã€‚æ”¹å˜ **state** çš„æƒŸä¸€æ–¹æ³•æ˜¯ **dispatch action**ã€‚\n\n``` typescript\nconst store = {\n  dispatch: dispatch as Dispatch\u003cA\u003e,\n  subscribe,\n  getState,\n  replaceReducer,\n  [$$observable]: observable\n} as unknown as Store\u003cExtendState\u003cS, StateExt\u003e, A, StateExt, Ext\u003e \u0026 Ext\nreturn store\n```\n\n## ä»£ç ç»“æ„\nä¾¿äºç†è§£ï¼Œæˆ‘ä»¬å¿½ç•¥å‡½æ•°ä¸­ **TS** çš„ä¸€äº›ç±»å‹å®šä¹‰ï¼Œå¤§è‡´ç»“æ„å¦‚ä¸‹ï¼š\n\n``` javascript\nfunction createStore(reducer, preloadedState, enhancer) {\n  // ä¼ å…¥å‚æ•°çš„åˆ¤æ–­\n  // ...\n\n  // å‚æ•°ä¸­enhancer functionå­˜åœ¨ï¼Œä¸€èˆ¬æ˜¯æŒ‡applyMiddleware()\n  if (typeof enhancer !== \"undefined\" \u0026\u0026 typeof enhancer === \"function\") {\n    return enhancer(createStore)(reducer, preloadedState);\n  }\n\n  let currentReducer = reducer; // å½“å‰storeä¸­çš„reducer\n  let currentState = preloadedState; // å½“å‰storeä¸­å­˜å‚¨çš„çŠ¶æ€\n  let currentListeners = []; // å½“å‰storeä¸­æ”¾ç½®çš„ç›‘å¬å‡½æ•°\n  let nextListeners = currentListeners; // ä¸‹ä¸€æ¬¡dispatchæ—¶çš„ç›‘å¬å‡½æ•°\n  let isDispatching = false; // ç”¨äºåˆ¤æ–­æ˜¯å¦æ­£åœ¨dispatch\n\n  // è·å–state\n  function getState() {\n    //...\n  }\n\n  // æ·»åŠ ä¸€ä¸ªç›‘å¬å‡½æ•°ï¼Œæ¯å½“dispatchè¢«è°ƒç”¨çš„æ—¶å€™éƒ½ä¼šæ‰§è¡Œè¿™ä¸ªç›‘å¬å‡½æ•°\n  function subscribe() {\n    //...\n  }\n\n  // è§¦å‘äº†ä¸€ä¸ªactionï¼Œå› æ­¤æˆ‘ä»¬è°ƒç”¨reducerï¼Œå¾—åˆ°çš„æ–°çš„stateï¼Œå¹¶ä¸”æ‰§è¡Œæ‰€æœ‰æ·»åŠ åˆ°storeä¸­çš„ç›‘å¬å‡½æ•°ã€‚\n  function dispatch() {\n    //...\n  }\n\n  // å¿½ç•¥ä¸¤ä¸ªä¸å¸¸ç”¨çš„æ–¹æ³•replaceReducerï¼Œobservable...\n\n  // createStoreçš„æ—¶å€™ä¼šæ‰§è¡Œä¸€æ¬¡INIT actionçš„dispatch\n  // ä¾¿äºå…¶ä»–reducerè·å–åˆå§‹å€¼\n  dispatch({ type: ActionTypes.INIT } as A);\n\n  return {\n    dispatch,\n    subscribe,\n    getState,\n    //ä¸‹é¢ä¸¤ä¸ªæ˜¯ä¸»è¦é¢å‘åº“å¼€å‘è€…çš„æ–¹æ³•ï¼Œæš‚æ—¶å…ˆå¿½ç•¥\n    //replaceReducer,\n    //observable\n  };\n}\n```\n\nå¯ä»¥çœ‹å‡ºï¼Œ**createStore** æ–¹æ³•åˆ›å»ºäº†ä¸€ä¸ª **store**ï¼Œä½†æ˜¯å¹¶æ²¡æœ‰ç›´æ¥å°†è¿™ä¸ª **store** çš„çŠ¶æ€ **state** è¿”å›ï¼Œè€Œæ˜¯è¿”å›äº†ä¸€ç³»åˆ—æ–¹æ³•ï¼Œå¤–éƒ¨å¯ä»¥é€šè¿‡è¿™äº›æ–¹æ³•ï¼ˆ**getState**ï¼‰è·å– **state**ï¼Œæˆ–è€…é—´æ¥åœ°ï¼ˆé€šè¿‡è°ƒç”¨ **dispatch** ï¼‰æ”¹å˜ **state**ã€‚\n\nä¸‹é¢æˆ‘ä»¬æ¥çœ‹ä¸‹å„ä¸ªæ–¹æ³•çš„å…·ä½“å®ç°\n\n### getState\n\n``` typescript\nfunction getState(): S {\n  // å¦‚æœæ­£åœ¨dispathä¼šæŠ›å‡ºå¼‚å¸¸\n  if (isDispatching) {\n    throw new Error(\n      'You may not call store.getState() while the reducer is executing. ' +\n        'The reducer has already received the state as an argument. ' +\n        'Pass it down from the top reducer instead of reading it from the store.'\n    )\n  }\n\n  return currentState as S\n}\n```\n\nå¾ˆç®€å•ï¼Œå°±æ˜¯è·å–å½“å‰ **state**ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ ``` store.getState() = ... ``` æ¥ä¿®æ”¹ **state**ï¼Œä½†æ˜¯ä¸€èˆ¬æ¥è¯´ï¼Œreduxä¸å»ºè®®è¿™æ ·åšï¼Œåªèƒ½é€šè¿‡ **dispatch action** æ¥ä¿®æ”¹ **state**ã€‚\n\n### subscribe\n\n``` typescript\n  // è‹¥ç›¸ç­‰ï¼Œåšä¸€ä¸‹currentListenersæµ…æ‹·è´\n  function ensureCanMutateNextListeners() {\n    if (nextListeners === currentListeners) {\n      nextListeners = currentListeners.slice()\n    }\n  }\n\n  function subscribe(listener: () =\u003e void) {\n    if (typeof listener !== 'function') {\n      // throw Error\n    }\n    if (isDispatching) {\n      // throw Error\n    }\n    //è®¾ç½®ä¸€ä¸ªæ ‡å¿—ï¼Œæ ‡å¿—è¯¥ç›‘å¬å™¨å·²ç»è®¢é˜…äº†\n    let isSubscribed = true\n\n    ensureCanMutateNextListeners()\n    // pushåˆ°nextListenersæ•°ç»„ä¸­ï¼Œä¸‹æ¬¡dispatchä¼šè°ƒç”¨\n    nextListeners.push(listener)\n\n    // è¿”å›äº†ä¸€ä¸ªå–æ¶ˆè®¢é˜…çš„å‡½æ•°ï¼Œå³ä»æ•°ç»„ä¸­åˆ é™¤è¯¥ç›‘å¬å‡½æ•°\n    return function unsubscribe() {\n      // å¦‚æœå·²ç»å–æ¶ˆè®¢é˜…è¿‡äº†ï¼Œç›´æ¥è¿”å›\n      if (!isSubscribed) {\n        return\n      }\n      if (isDispatching) {\n        // throw Error\n      }\n\n      isSubscribed = false\n\n      ensureCanMutateNextListeners()\n      // ä»ä¸‹ä¸€è½®çš„ç›‘å¬å‡½æ•°æ•°ç»„ï¼ˆç”¨äºä¸‹ä¸€æ¬¡dispatchï¼‰ä¸­åˆ é™¤è¿™ä¸ªç›‘å¬å™¨ã€‚\n      const index = nextListeners.indexOf(listener)\n      nextListeners.splice(index, 1)\n      // æ¸…ç©ºå½“å‰currentListeners\n      currentListeners = null\n    }\n  }\n```\n\n### dispatch\n\n``` typescript\nfunction dispatch(action: A) {\n  if (!isPlainObject(action)) {\n    // throw Error\n  }\n\n  if (typeof action.type === 'undefined') {\n    // throw Error\n  }\n\n  if (isDispatching) {\n    // throw Error\n  }\n\n  try {\n    // æ ‡è®°æ­£åœ¨dispatch\n    isDispatching = true\n    // è°ƒç”¨reducerï¼Œå¾—åˆ°æ–°state\n    currentState = currentReducer(currentState, action)\n  } finally {\n    isDispatching = false\n  }\n\n  const listeners = (currentListeners = nextListeners)\n  // éå†æ‰§è¡Œç›‘å¬æ•°ç»„ä¸­çš„æ‰€æœ‰ç›‘å¬å‡½æ•°\n  for (let i = 0; i \u003c listeners.length; i++) {\n    const listener = listeners[i]\n    listener()\n  }\n\n  // è¿”å›ä¼ å…¥çš„action\n  return action\n}\n```\n\n**dispatch** æ˜¯ä¿®æ”¹ **state** çš„å”¯ä¸€é€”å¾„ï¼ˆ**redux** è§„å®šï¼‰ã€‚\n\n## æ€»ç»“\næ•´ä¸ª **createStore** function è¿˜æ˜¯æ¯”è¾ƒå®¹æ˜“ç†è§£çš„ï¼Œè®°ä½åº”ç”¨ä¸­åº”æœ‰ä¸”ä»…æœ‰ä¸€ä¸ª storeã€‚\n\n## å‚è€ƒ\n- [Redux createStore API](https://redux.js.org/api/createstore)\n- [Redux createStore APIï¼ˆä¸­æ–‡ç‰ˆï¼‰](https://www.redux.org.cn/docs/api/createStore.html)\n"},"nextPost":{"slug":"currying","frontmatter":{"title":"æŸ¯é‡ŒåŒ–-Currying","date":"June 23, 2021","description":null},"excerpt":"","content":"\nä¹‹å‰çœ‹ **Redux compose** éƒ¨åˆ†æºä»£ç çš„æ—¶å€™ï¼Œå°±æ„Ÿè§‰å’Œ **æŸ¯é‡ŒåŒ–ï¼ˆCurryingï¼‰** å¾ˆåƒï¼Œæ‰€ä»¥è¿™ç¯‡æŠŠå®ƒå®‰æ’ä¸Šäº†ï¼ŒåŒå±äºå‡½æ•°å¼ç¼–ç¨‹èŒƒç•´ã€‚\n\n## What\n\nä»€ä¹ˆæ˜¯æŸ¯é‡ŒåŒ–ï¼ˆCurryingï¼‰\n\n**æŸ¯é‡ŒåŒ–** å¤§å®¶åº”è¯¥å¬è¯´è¿‡ï¼Œæˆ–è®¸è¿˜æœ‰äº›äº†è§£ï¼Œä½†æ˜¯åˆ°åº•ä»€ä¹ˆæ ·çš„èŒƒå¼æ‰æ˜¯æŸ¯é‡ŒåŒ–å‘¢ï¼Ÿ\n\n\u003eåœ¨ç»´åŸºç™¾ç§‘ä¸Šçš„å®šä¹‰æ˜¯è¿™æ ·ï¼š***currying is the technique of converting a function that takes multiple arguments into a sequence of functions that each takes a single argument***.\n\né¦–å…ˆæ˜¯ä¸€ä¸ªæŠ€æœ¯ï¼Œä½œç”¨æ˜¯å°†ä¸€ä¸ªæ‹¥æœ‰å¤šä¸ªå‚æ•°çš„å‡½æ•°è½¬åŒ–æˆä¸€ç³»åˆ—åªèƒ½ä¼ å…¥ä¸€ä¸ªå‚æ•°çš„å‡½æ•°ã€‚\n\nè¿˜æ˜¯æ¯”è¾ƒæŠ½è±¡ï¼Œé€šè¿‡ä»£ç \n\n``` js\nconst add = (x) =\u003e (y) =\u003e x + y;\n```\n\nè¿™ç§å¤š **=\u003e** çš„ä»£ç ç»å¸¸è§ï¼Œå…¶å®å°±æ˜¯ **ES6** ç‰ˆçš„æŸ¯é‡ŒåŒ–ï¼Œæˆ‘ä»¬å¯ä»¥è½¬åŒ–ä¸‹\n\nè§‰å¾—ç†è§£å›°éš¾çš„å¯ä»¥å€Ÿç”¨ **[Babel](https://www.babeljs.cn/repl)** æ¥è½¬åŒ–\n\n``` js\nvar add = function add(x) {\n  return function (y) {\n    return x + y;\n  };\n};\n```\n\nä¸ç”¨ **æŸ¯é‡ŒåŒ–ï¼ˆCurryingï¼‰**:\n\n``` js\nconst add = (a, b, c) =\u003e {\n  return a + b + c;\n}\n```\n\nåœ¨æ•°å­¦å’Œè®¡ç®—æœºç§‘å­¦ä¸­çš„æŸ¯é‡ŒåŒ–å‡½æ•°ï¼Œä¸€æ¬¡åªèƒ½ä¼ é€’ä¸€ä¸ªå‚æ•°ï¼›\n\nè€Œæˆ‘ä»¬ **Javascript** å®é™…åº”ç”¨ä¸­çš„æŸ¯é‡ŒåŒ–å‡½æ•°ï¼Œå¯ä»¥ä¼ é€’ä¸€ä¸ªæˆ–å¤šä¸ªå‚æ•°ã€‚\n\n``` js\n//æ™®é€šå‡½æ•°\nfunction fn(a, b, c, d, e) {\n  return a + b + c + d + e;\n}\n//ç”Ÿæˆçš„æŸ¯é‡ŒåŒ–å‡½æ•°\nconst curryFn = curry(fn);\n\ncurryFn(1,2,3,4,5);     // 15\ncurryFn(1)(2)(3,4,5);   // 15\ncurryFn(1,2)(3,4)(5);   // 15\ncurryFn(1)(2)(3)(4)(5); // 15\n\n```\n\né‚£ä¹ˆä»€ä¹ˆæ—¶å€™åº”è¯¥ç”¨ **æŸ¯é‡ŒåŒ–ï¼ˆCurryingï¼‰** å‘¢ï¼Œæ€»ä¸è‡³äºæˆ‘ä»¬å°±æ˜¯ç”¨æ¥ä¸ºäº†ç»™ä¸‰ä¸ªæ•°å­—æ±‚å’Œã€‚\n\n## When\n\nä¸¾ä¸ªä¾‹å­ğŸŒ°\n\nç§‘é¢œæ°æœ‰ä¸€æ¬¾çˆ†ç«çš„çˆ½è‚¤æ°´ï¼Œç»å¸¸ä¼šæœ‰æ´»åŠ¨ä¿ƒé”€æ‰“æŠ˜ï¼Œæ‰“æŠ˜åŠ›åº¦å¾€å¾€ä¸ä¸€æ ·\n\næ‰€ä»¥ä»–ä»¬ä¼šè¿™æ ·è®¡ç®—æŠ˜åä»·æ ¼\n\n``` js\nconst discountPrice = (price, dicount) =\u003e {\n  return price * dicount;\n}\n\ndiscountPrice(300, 0.9);\ndiscountPrice(300, 0.95);\ndiscountPrice(300, 0.85);\ndiscountPrice(300, 0.88);\n```\n\nå…¶å®æˆ‘ä»¬ä¼šå‘ç°ï¼Œè™½ç„¶æŠ˜æ‰£ç»å¸¸å˜ï¼Œä½†æ˜¯å®ƒæœ¬èº«çš„ä»·æ ¼åŸºæœ¬ä¸å˜\n\næ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç”¨ **æŸ¯é‡ŒåŒ–ï¼ˆCurryingï¼‰** ä¼˜åŒ–ä¸‹ä»£ç ç»“æ„\n\n``` js\nconst defaultPrice = 300; // çˆ½è‚¤æ°´é»˜è®¤ä»·æ ¼\n\nconst discountPrice = (price) =\u003e {\n  return (dicount) =\u003e {\n    return price * dicount;\n  }\n}\n\n// const discountPrice = price =\u003e dicount =\u003e price * dicount\n\nconst tonerdDscountPrice = discountPrice(defaultPrice);\n\ntonerdDscountPrice(0.9);\ntonerdDscountPrice(0.95);\ntonerdDscountPrice(0.85);\ntonerdDscountPrice(0.88);\n```\n\nä¸‹é¢çš„ä»£ç æ˜¯ä¸æ˜¯è°ƒç”¨çš„æ—¶å€™æ›´åŠ èˆ’çˆ½ä¸€ç‚¹\n\n## Why\n\né‚£ä¹ˆ **æŸ¯é‡ŒåŒ–ï¼ˆCurryingï¼‰** æœ‰å•¥å¥½å¤„å‘¢\n\næŸ¯é‡ŒåŒ–æœ¬è´¨ä¸Šæ˜¯ ***é™ä½é€šç”¨æ€§ï¼Œæé«˜é€‚ç”¨æ€§***ã€‚\n\næ€ä¹ˆç†è§£...\n\nç»“åˆæ‰“æŠ˜çš„ä¾‹å­çœ‹ï¼Œ\n\né™ä½é€šç”¨æ€§æ˜¯æŒ‡ **Currying** ä¹‹å‰ï¼Œæˆ‘ä»¬å¯ä»¥çµæ´»çš„ä¼ å…¥é»˜è®¤ä»·æ ¼ï¼Œæˆ‘å¯ä»¥ç®—å‡ºçˆ½è‚¤æ°´æŠ˜æ‰£ä»·æ ¼ï¼Œä¹Ÿå¯ä»¥ç®—å‡ºé¢è†œæŠ˜æ‰£ä»·æ ¼ï¼Œå¾ˆé€šç”¨\n\nä½†æ˜¯ **Currying** ä¹‹åæ›´åŠ é€‚ç”¨äºç®—å‡ºçˆ½è‚¤æ°´æŠ˜æ‰£ä»·æ ¼äº†ï¼Œéƒ½ä¸ç”¨ä¼ å…¥é»˜è®¤ä»·æ ¼äº†ï¼Œæå–äº†ä¸€ä¸ªé€šç”¨çš„æ–¹æ³•å¯¹é»˜è®¤ä»·æ ¼è¿›è¡Œå¤„ç†ï¼Œåªè¦ä¼ å…¥æŠ˜æ‰£ä»·æ ¼\n\næ‰€ä»¥ï¼Œå…³äºä½¿ç”¨å…¶å®æ˜¯ä¸ªå–èˆé—®é¢˜ï¼Œéœ€ç»“åˆå…·ä½“åœºæ™¯\n\n\n\n\n\n\n\n## å‚è€ƒ\n- [currying-javascript](https://www.dottedsquirrel.com/currying-javascript/)\n- [wiki-Currying](https://en.wikipedia.org/wiki/Currying)\n- [javascript-currying-what-is-the-point-of-currying-javascript-functions](https://www.jondjones.com/frontend/javascript/functional-programming/javascript-currying-what-is-the-point-of-currying-javascript-functions/)\n- [ã€Œå‰ç«¯è¿›é˜¶ã€å½»åº•å¼„æ‡‚å‡½æ•°æŸ¯é‡ŒåŒ–](https://juejin.cn/post/6844903882208837645)"}},"__N_SSG":true},"page":"/post/[slug]","query":{"slug":"compose"},"buildId":"1wLYIEwa2v4B32jfLPdOy","nextExport":false,"isFallback":false,"gsp":true}</script><script nomodule="" src="/_next/static/chunks/polyfills-8f31809deb7932dd0187.js"></script><script src="/_next/static/chunks/main-c6f966696d7d46f48c33.js" async=""></script><script src="/_next/static/chunks/webpack-50bee04d1dc61f8adf5b.js" async=""></script><script src="/_next/static/chunks/framework.10b3d8f36ae5d485c3da.js" async=""></script><script src="/_next/static/chunks/commons.18cd929bdef6e2f96561.js" async=""></script><script src="/_next/static/chunks/pages/_app-8092af36005895da29ff.js" async=""></script><script src="/_next/static/chunks/1173eff4538ab0eae4f3f506dea9a7965770ad37.7e8955d2d0e73ced77f4.js" async=""></script><script src="/_next/static/chunks/pages/post/%5Bslug%5D-5905726faed1db0b6bb8.js" async=""></script><script src="/_next/static/1wLYIEwa2v4B32jfLPdOy/_buildManifest.js" async=""></script><script src="/_next/static/1wLYIEwa2v4B32jfLPdOy/_ssgManifest.js" async=""></script></body></html>